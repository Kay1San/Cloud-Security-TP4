{
  "SchemaVersion": 2,
  "ReportID": "019b00de-7d83-7d46-a31d-983013ee1f30",
  "CreatedAt": "2025-12-08T21:08:59.7798701-05:00",
  "ArtifactName": ".",
  "ArtifactType": "filesystem",
  "Results": [
    {
      "Target": ".",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 58,
        "Failures": 0
      }
    },
    {
      "Target": "iac-code.tf",
      "Class": "config",
      "Type": "terraform",
      "MisconfSummary": {
        "Successes": 0,
        "Failures": 12
      },
      "Misconfigurations": [
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0086",
          "AVDID": "AVD-AWS-0086",
          "Title": "S3 Access block should block public ACL",
          "Description": "S3 buckets should block public ACLs on buckets and any objects they contain. By blocking, PUTs with fail if the object has any public ACL a.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0086",
          "Query": "data.builtin.aws.s3.aws0086.deny",
          "Resolution": "Enable blocking any PUT calls with a public ACL specified",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0086",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0086"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0087",
          "AVDID": "AVD-AWS-0087",
          "Title": "S3 Access block should block public policy",
          "Description": "S3 bucket policy should have block public policy to prevent users from putting a policy that enable public access.\n",
          "Message": "No public access block so not blocking public policies",
          "Namespace": "builtin.aws.s3.aws0087",
          "Query": "data.builtin.aws.s3.aws0087.deny",
          "Resolution": "Prevent policies that allow public access being PUT",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0087",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0087"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0088",
          "AVDID": "AVD-AWS-0088",
          "Title": "Unencrypted S3 bucket.",
          "Description": "S3 Buckets should be encrypted to protect the data that is stored within them if access is compromised.\n",
          "Message": "Bucket does not have encryption enabled",
          "Namespace": "builtin.aws.s3.aws0088",
          "Query": "data.builtin.aws.s3.aws0088.deny",
          "Resolution": "Configure bucket encryption",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0088",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0088"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "s3-bucket-logging",
          "AVDID": "AVD-AWS-0089",
          "Title": "S3 Bucket Logging",
          "Description": "Ensures S3 bucket logging is enabled for S3 buckets",
          "Message": "Bucket has logging disabled",
          "Namespace": "builtin.aws.s3.aws0089",
          "Query": "data.builtin.aws.s3.aws0089.deny",
          "Resolution": "Add a logging block to the resource to enable access logging",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/s3-bucket-logging",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/ServerLogs.html",
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html",
            "https://avd.aquasec.com/misconfig/s3-bucket-logging"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0090",
          "AVDID": "AVD-AWS-0090",
          "Title": "S3 Data should be versioned",
          "Description": "Versioning in Amazon S3 is a means of keeping multiple variants of an object in the same bucket.\n\nYou can use the S3 Versioning feature to preserve, retrieve, and restore every version of every object stored in your buckets.\n\nWith versioning you can recover more easily from both unintended user actions and application failures.\n\nWhen you enable versioning, also keep in mind the potential costs of storing noncurrent versions of objects. To help manage those costs, consider setting up an S3 Lifecycle configuration.\n",
          "Message": "Bucket does not have versioning enabled",
          "Namespace": "builtin.aws.s3.aws0090",
          "Query": "data.builtin.aws.s3.aws0090.deny",
          "Resolution": "Enable versioning to protect against accidental/malicious removal or modification",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0090",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/Versioning.html",
            "https://aws.amazon.com/blogs/storage/reduce-storage-costs-with-fewer-noncurrent-versions-using-amazon-s3-lifecycle/",
            "https://avd.aquasec.com/misconfig/avd-aws-0090"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0091",
          "AVDID": "AVD-AWS-0091",
          "Title": "S3 Access Block should Ignore Public ACL",
          "Description": "S3 buckets should ignore public ACLs on buckets and any objects they contain. By ignoring rather than blocking, PUT calls with public ACLs will still be applied but the ACL will be ignored.\n",
          "Message": "No public access block so not blocking public acls",
          "Namespace": "builtin.aws.s3.aws0091",
          "Query": "data.builtin.aws.s3.aws0091.deny",
          "Resolution": "Enable ignoring the application of public ACLs in PUT calls",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0091",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0091"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0093",
          "AVDID": "AVD-AWS-0093",
          "Title": "S3 Access block should restrict public bucket to limit access",
          "Description": "S3 buckets should restrict public policies for the bucket. By enabling, the restrict_public_buckets, only the bucket owner and AWS Services can access if it has a public policy.\n",
          "Message": "No public access block so not restricting public buckets",
          "Namespace": "builtin.aws.s3.aws0093",
          "Query": "data.builtin.aws.s3.aws0093.deny",
          "Resolution": "Limit the access to public buckets to only the owner or AWS Services (eg; CloudFront)",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0093",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/dev-retired/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0093"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0094",
          "AVDID": "AVD-AWS-0094",
          "Title": "S3 buckets should each define an aws_s3_bucket_public_access_block",
          "Description": "The \"block public access\" settings in S3 override individual policies that apply to a given bucket, meaning that all public access can be controlled in one central types for that bucket. It is therefore good practice to define these settings for each bucket in order to clearly define the public access that can be allowed for it.\n",
          "Message": "Bucket does not have a corresponding public access block.",
          "Namespace": "builtin.aws.s3.aws0094",
          "Query": "data.builtin.aws.s3.aws0094.deny",
          "Resolution": "Define a aws_s3_bucket_public_access_block for the given bucket to control public access policies",
          "Severity": "LOW",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0094",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0094"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "AVD-AWS-0132",
          "AVDID": "AVD-AWS-0132",
          "Title": "S3 encryption should use Customer Managed Keys",
          "Description": "Encryption using AWS keys provides protection for your S3 buckets. To increase control of the encryption and manage factors like rotation use customer managed keys.\n",
          "Message": "Bucket does not encrypt data with a customer managed key.",
          "Namespace": "builtin.aws.s3.aws0132",
          "Query": "data.builtin.aws.s3.aws0132.deny",
          "Resolution": "Enable encryption using customer managed keys",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/avd-aws-0132",
          "References": [
            "https://docs.aws.amazon.com/AmazonS3/latest/userguide/bucket-encryption.html",
            "https://avd.aquasec.com/misconfig/avd-aws-0132"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_s3_bucket.S3Bucket",
            "Provider": "AWS",
            "Service": "s3",
            "StartLine": 14,
            "EndLine": 16,
            "Code": {
              "Lines": [
                {
                  "Number": 14,
                  "Content": "resource \"aws_s3_bucket\" \"S3Bucket\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_s3_bucket\"\u001b[0m \u001b[38;5;37m\"S3Bucket\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 15,
                  "Content": "    bucket = \"polystudents3-boto3-1584966-source\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mbucket\u001b[0m = \u001b[38;5;37m\"polystudents3-boto3-1584966-source\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 16,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_subnet.EC2Subnet3",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 46,
            "EndLine": 46,
            "Code": {
              "Lines": [
                {
                  "Number": 42,
                  "Content": "resource \"aws_subnet\" \"EC2Subnet3\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"EC2Subnet3\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 43,
                  "Content": "    availability_zone = \"us-east-1b\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;37m\"us-east-1b\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 44,
                  "Content": "    cidr_block = \"10.0.16.0/24\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"10.0.16.0/24\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 45,
                  "Content": "    vpc_id = \"${aws_vpc.EC2VPC.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mvpc_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_vpc.EC2VPC.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 46,
                  "Content": "    map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 47,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.EC2Subnet3",
                "Filename": "iac-code.tf",
                "Location": {
                  "StartLine": 42,
                  "EndLine": 47
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-vpc-no-public-ingress-sgr",
          "AVDID": "AVD-AWS-0164",
          "Title": "Instances in a subnet should not receive a public IP address by default.",
          "Description": "You should limit the provision of public IP addresses for resources. Resources should not be exposed on the public internet, but should have access limited to consumers required for the function of your application.\n",
          "Message": "Subnet associates public IP address.",
          "Namespace": "builtin.aws.ec2.aws0164",
          "Query": "data.builtin.aws.ec2.aws0164.deny",
          "Resolution": "Set the instance to not be publicly accessible",
          "Severity": "HIGH",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses",
            "https://avd.aquasec.com/misconfig/aws-vpc-no-public-ingress-sgr"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_subnet.EC2Subnet4",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 53,
            "EndLine": 53,
            "Code": {
              "Lines": [
                {
                  "Number": 49,
                  "Content": "resource \"aws_subnet\" \"EC2Subnet4\" {",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_subnet\"\u001b[0m \u001b[38;5;37m\"EC2Subnet4\"\u001b[0m {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 50,
                  "Content": "    availability_zone = \"us-east-1a\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mavailability_zone\u001b[0m = \u001b[38;5;37m\"us-east-1a\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 51,
                  "Content": "    cidr_block = \"10.0.0.0/24\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"10.0.0.0/24\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 52,
                  "Content": "    vpc_id = \"${aws_vpc.EC2VPC.id}\"",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mvpc_id\u001b[0m = \u001b[38;5;37m\"\u001b[0m\u001b[38;5;37m${\u001b[0maws_vpc.EC2VPC.id\u001b[38;5;37m}\u001b[0m\u001b[38;5;37m\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 53,
                  "Content": "    map_public_ip_on_launch = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mmap_public_ip_on_launch\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": true,
                  "LastCause": true
                },
                {
                  "Number": 54,
                  "Content": "}",
                  "IsCause": false,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m}",
                  "FirstCause": false,
                  "LastCause": false
                }
              ]
            },
            "Occurrences": [
              {
                "Resource": "aws_subnet.EC2Subnet4",
                "Filename": "iac-code.tf",
                "Location": {
                  "StartLine": 49,
                  "EndLine": 54
                }
              }
            ]
          }
        },
        {
          "Type": "Terraform Security Check",
          "ID": "aws-autoscaling-enable-at-rest-encryption",
          "AVDID": "AVD-AWS-0178",
          "Title": "VPC Flow Logs is a feature that enables you to capture information about the IP traffic going to and from network interfaces in your VPC. After you've created a flow log, you can view and retrieve its data in Amazon CloudWatch Logs. It is recommended that VPC Flow Logs be enabled for packet \"Rejects\" for VPCs.",
          "Description": "VPC Flow Logs provide visibility into network traffic that traverses the VPC and can be used to detect anomalous traffic or insight during security workflows.\n",
          "Message": "VPC does not have VPC Flow Logs enabled.",
          "Namespace": "builtin.aws.ec2.aws0178",
          "Query": "data.builtin.aws.ec2.aws0178.deny",
          "Resolution": "Enable flow logs for VPC",
          "Severity": "MEDIUM",
          "PrimaryURL": "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption",
          "References": [
            "https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/RootDeviceStorage.html",
            "https://avd.aquasec.com/misconfig/aws-autoscaling-enable-at-rest-encryption"
          ],
          "Status": "FAIL",
          "CauseMetadata": {
            "Resource": "aws_vpc.EC2VPC",
            "Provider": "AWS",
            "Service": "ec2",
            "StartLine": 18,
            "EndLine": 26,
            "Code": {
              "Lines": [
                {
                  "Number": 18,
                  "Content": "resource \"aws_vpc\" \"EC2VPC\" {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[38;5;33mresource\u001b[0m \u001b[38;5;37m\"aws_vpc\"\u001b[0m \u001b[38;5;37m\"EC2VPC\"\u001b[0m {",
                  "FirstCause": true,
                  "LastCause": false
                },
                {
                  "Number": 19,
                  "Content": "    cidr_block = \"10.0.0.0/16\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "    \u001b[38;5;245mcidr_block\u001b[0m = \u001b[38;5;37m\"10.0.0.0/16\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 20,
                  "Content": "    enable_dns_support = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245menable_dns_support\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 21,
                  "Content": "    enable_dns_hostnames = true",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245menable_dns_hostnames\u001b[0m = \u001b[38;5;166mtrue",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 22,
                  "Content": "    instance_tenancy = \"default\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245minstance_tenancy\u001b[0m = \u001b[38;5;37m\"default\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 23,
                  "Content": "    tags = {",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    \u001b[38;5;245mtags\u001b[0m = {",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 24,
                  "Content": "        Name = \"polystudent-vpc-boto3\"",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "        \u001b[38;5;245mName\u001b[0m = \u001b[38;5;37m\"polystudent-vpc-boto3\"",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 25,
                  "Content": "    }",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "\u001b[0m    }",
                  "FirstCause": false,
                  "LastCause": false
                },
                {
                  "Number": 26,
                  "Content": "}",
                  "IsCause": true,
                  "Annotation": "",
                  "Truncated": false,
                  "Highlighted": "}",
                  "FirstCause": false,
                  "LastCause": true
                }
              ]
            }
          }
        }
      ]
    }
  ]
}
